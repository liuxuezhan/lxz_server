--lxz
--科技升级

local mod = {}

function mod.action( _idx )
    local p = get_account()
    chat( p, "@set_val=gold=100000000" )
    chat( p, "@buildtop" )
    chat( p, "@addbuf=1=-1" )
    chat( p, "@addres=1=10000000" )
    sync( p )

    local build = get_build( p, 0, 10 )
    for _, id in pairs( tech_sort ) do 
        local v = resmng.prop_tech[id] 
        local buff = {}
        for k, v in pairs( v.Effect ) do 
            Rpc:get_buff( p, k )
            wait_for_ack( p, "get_buff" )
            buff[k]=p.buff[k]
        end
--        lxz(p.account,build.idx,v.ID)
        Rpc:learn_tech(p,build.idx,v.ID,1)
        wait_for_ack( p, "statePro" )
        for what, _ in pairs( buff ) do 
            Rpc:get_buff( p, what )
            wait_for_ack( p, "get_buff" )
            local add = 0
            if  v.Lv > 1 then
                add = v.Effect[what] - resmng.prop_tech[v.ID-1].Effect[what]
            else
                add = v.Effect[what] 
            end
            if buff[what] + add  ~= p.buff[what] then return "fail" end
        end
    end

    return "ok"
end

tech_sort = {
    1001001,
    1001002,
    1001003,
    1001004,
    1001005,
    1007001,
    1007002,
    1007003,
    1007004,
    1007005,
    1025001,
    1025002,
    1025003,
    1025004,
    1025005,
    1004001,
    1004002,
    1004003,
    1004004,
    1004005,
    1010001,
    1010002,
    1010003,
    1010004,
    1010005,
    1002001,
    1002002,
    1002003,
    1002004,
    1002005,
    1002006,
    1002007,
    1002008,
    1002009,
    1002010,
    1008001,
    1008002,
    1008003,
    1008004,
    1008005,
    1008006,
    1008007,
    1008008,
    1008009,
    1008010,
    1013001,
    1013002,
    1013003,
    1013004,
    1013005,
    1016001,
    1016002,
    1016003,
    1016004,
    1016005,
    1026001,
    1026002,
    1026003,
    1026004,
    1026005,
    1026006,
    1026007,
    1026008,
    1026009,
    1026010,
    1005001,
    1005002,
    1005003,
    1005004,
    1005005,
    1005006,
    1005007,
    1005008,
    1005009,
    1005010,
    1011001,
    1011002,
    1011003,
    1011004,
    1011005,
    1011006,
    1011007,
    1011008,
    1011009,
    1011010,
    1003001,
    1003002,
    1003003,
    1003004,
    1003005,
    1003006,
    1003007,
    1003008,
    1003009,
    1003010,
    1003011,
    1003012,
    1003013,
    1003014,
    1003015,
    1003016,
    1003017,
    1003018,
    1003019,
    1003020,
    1019001,
    1019002,
    1019003,
    1019004,
    1019005,
    1009001,
    1009002,
    1009003,
    1009004,
    1009005,
    1009006,
    1009007,
    1009008,
    1009009,
    1009010,
    1009011,
    1009012,
    1009013,
    1009014,
    1009015,
    1009016,
    1009017,
    1009018,
    1009019,
    1009020,
    1022001,
    1022002,
    1022003,
    1022004,
    1022005,
    1014001,
    1014002,
    1014003,
    1014004,
    1014005,
    1014006,
    1014007,
    1014008,
    1014009,
    1014010,
    1017001,
    1017002,
    1017003,
    1017004,
    1017005,
    1017006,
    1017007,
    1017008,
    1017009,
    1017010,
    1020001,
    1020002,
    1020003,
    1020004,
    1020005,
    1020006,
    1020007,
    1020008,
    1020009,
    1020010,
    1006001,
    1006002,
    1006003,
    1006004,
    1006005,
    1006006,
    1006007,
    1006008,
    1006009,
    1006010,
    1006011,
    1006012,
    1006013,
    1006014,
    1006015,
    1006016,
    1006017,
    1006018,
    1006019,
    1006020,
    1012001,
    1012002,
    1012003,
    1012004,
    1012005,
    1012006,
    1012007,
    1012008,
    1012009,
    1012010,
    1012011,
    1012012,
    1012013,
    1012014,
    1012015,
    1012016,
    1012017,
    1012018,
    1012019,
    1012020,
    1027001,
    1027002,
    1027003,
    1027004,
    1027005,
    1027006,
    1027007,
    1027008,
    1027009,
    1027010,
    1027011,
    1027012,
    1027013,
    1027014,
    1027015,
    1015001,
    1015002,
    1015003,
    1015004,
    1015005,
    1015006,
    1015007,
    1015008,
    1015009,
    1015010,
    1015011,
    1015012,
    1015013,
    1015014,
    1015015,
    1015016,
    1015017,
    1015018,
    1015019,
    1015020,
    1023001,
    1023002,
    1023003,
    1023004,
    1023005,
    1023006,
    1023007,
    1023008,
    1023009,
    1023010,
    1018001,
    1018002,
    1018003,
    1018004,
    1018005,
    1018006,
    1018007,
    1018008,
    1018009,
    1018010,
    1018011,
    1018012,
    1018013,
    1018014,
    1018015,
    1018016,
    1018017,
    1018018,
    1018019,
    1018020,
    1021001,
    1021002,
    1021003,
    1021004,
    1021005,
    1021006,
    1021007,
    1021008,
    1021009,
    1021010,
    1021011,
    1021012,
    1021013,
    1021014,
    1021015,
    1021016,
    1021017,
    1021018,
    1021019,
    1021020,
    1024001,
    1024002,
    1024003,
    1024004,
    1024005,
    1024006,
    1024007,
    1024008,
    1024009,
    1024010,
    1024011,
    1024012,
    1024013,
    1024014,
    1024015,
    1024016,
    1024017,
    1024018,
    1024019,
    1024020,
    2001001,
    2001002,
    2001003,
    2001004,
    2001005,
    2010001,
    2010002,
    2010003,
    2010004,
    2010005,
    2004001,
    2004002,
    2004003,
    2004004,
    2004005,
    2007001,
    2007002,
    2007003,
    2007004,
    2007005,
    2002001,
    2002002,
    2002003,
    2002004,
    2002005,
    2002006,
    2002007,
    2002008,
    2002009,
    2002010,
    2011001,
    2011002,
    2011003,
    2011004,
    2011005,
    2011006,
    2011007,
    2011008,
    2011009,
    2011010,
    2005001,
    2005002,
    2005003,
    2005004,
    2005005,
    2005006,
    2005007,
    2005008,
    2005009,
    2005010,
    2008001,
    2008002,
    2008003,
    2008004,
    2008005,
    2008006,
    2008007,
    2008008,
    2008009,
    2008010,
    2003001,
    2003002,
    2003003,
    2003004,
    2003005,
    2003006,
    2003007,
    2003008,
    2003009,
    2003010,
    2003011,
    2003012,
    2003013,
    2003014,
    2003015,
    2012001,
    2012002,
    2012003,
    2012004,
    2012005,
    2012006,
    2012007,
    2012008,
    2012009,
    2012010,
    2012011,
    2012012,
    2012013,
    2012014,
    2012015,
    2006001,
    2006002,
    2006003,
    2006004,
    2006005,
    2006006,
    2006007,
    2006008,
    2006009,
    2006010,
    2006011,
    2006012,
    2006013,
    2006014,
    2006015,
    2009001,
    2009002,
    2009003,
    2009004,
    2009005,
    2009006,
    2009007,
    2009008,
    2009009,
    2009010,
    2009011,
    2009012,
    2009013,
    2009014,
    2009015,
    3001001,
    3001002,
    3001003,
    3001004,
    3001005,
    3007001,
    3007002,
    3007003,
    3007004,
    3007005,
    3010001,
    3010002,
    3010003,
    3010004,
    3010005,
    3013001,
    3013002,
    3013003,
    3013004,
    3013005,
    3016001,
    3016002,
    3016003,
    3016004,
    3016005,
    3019001,
    3019002,
    3019003,
    3019004,
    3019005,
    3022001,
    3022002,
    3022003,
    3022004,
    3022005,
    3025001,
    3025002,
    3025003,
    3025004,
    3025005,
    3028001,
    3028002,
    3028003,
    3028004,
    3028005,
    3055001,
    3031001,
    3031002,
    3031003,
    3031004,
    3031005,
    3034001,
    3034002,
    3034003,
    3034004,
    3034005,
    3037001,
    3037002,
    3037003,
    3037004,
    3037005,
    3040001,
    3040002,
    3040003,
    3040004,
    3040005,
    3043001,
    3043002,
    3043003,
    3043004,
    3043005,
    3046001,
    3046002,
    3046003,
    3046004,
    3046005,
    3049001,
    3049002,
    3049003,
    3049004,
    3049005,
    3052001,
    3052002,
    3052003,
    3052004,
    3052005,
    3004001,
    3004002,
    3004003,
    3004004,
    3004005,
    3008001,
    3008002,
    3008003,
    3008004,
    3008005,
    3008006,
    3008007,
    3008008,
    3008009,
    3008010,
    3011001,
    3011002,
    3011003,
    3011004,
    3011005,
    3011006,
    3011007,
    3011008,
    3011009,
    3011010,
    3014001,
    3014002,
    3014003,
    3014004,
    3014005,
    3014006,
    3014007,
    3014008,
    3014009,
    3014010,
    3017001,
    3017002,
    3017003,
    3017004,
    3017005,
    3017006,
    3017007,
    3017008,
    3017009,
    3017010,
    3056001,
    3020001,
    3020002,
    3020003,
    3020004,
    3020005,
    3020006,
    3020007,
    3020008,
    3020009,
    3020010,
    3023001,
    3023002,
    3023003,
    3023004,
    3023005,
    3023006,
    3023007,
    3023008,
    3023009,
    3023010,
    3026001,
    3026002,
    3026003,
    3026004,
    3026005,
    3026006,
    3026007,
    3026008,
    3026009,
    3026010,
    3029001,
    3029002,
    3029003,
    3029004,
    3029005,
    3029006,
    3029007,
    3029008,
    3029009,
    3029010,
    3002001,
    3002002,
    3002003,
    3002004,
    3002005,
    3002006,
    3002007,
    3002008,
    3002009,
    3002010,
    3032001,
    3032002,
    3032003,
    3032004,
    3032005,
    3032006,
    3032007,
    3032008,
    3032009,
    3032010,
    3035001,
    3035002,
    3035003,
    3035004,
    3035005,
    3035006,
    3035007,
    3035008,
    3035009,
    3035010,
    3038001,
    3038002,
    3038003,
    3038004,
    3038005,
    3038006,
    3038007,
    3038008,
    3038009,
    3038010,
    3041001,
    3041002,
    3041003,
    3041004,
    3041005,
    3041006,
    3041007,
    3041008,
    3041009,
    3041010,
    3044001,
    3044002,
    3044003,
    3044004,
    3044005,
    3044006,
    3044007,
    3044008,
    3044009,
    3044010,
    3047001,
    3047002,
    3047003,
    3047004,
    3047005,
    3047006,
    3047007,
    3047008,
    3047009,
    3047010,
    3050001,
    3050002,
    3050003,
    3050004,
    3050005,
    3050006,
    3050007,
    3050008,
    3050009,
    3050010,
    3053001,
    3053002,
    3053003,
    3053004,
    3053005,
    3053006,
    3053007,
    3053008,
    3053009,
    3053010,
    3005001,
    3005002,
    3005003,
    3005004,
    3005005,
    3005006,
    3005007,
    3005008,
    3005009,
    3005010,
    3009001,
    3009002,
    3009003,
    3009004,
    3009005,
    3009006,
    3009007,
    3009008,
    3009009,
    3009010,
    3009011,
    3009012,
    3009013,
    3009014,
    3009015,
    3012001,
    3012002,
    3012003,
    3012004,
    3012005,
    3012006,
    3012007,
    3012008,
    3012009,
    3012010,
    3012011,
    3012012,
    3012013,
    3012014,
    3012015,
    3015001,
    3015002,
    3015003,
    3015004,
    3015005,
    3015006,
    3015007,
    3015008,
    3015009,
    3015010,
    3015011,
    3015012,
    3015013,
    3015014,
    3015015,
    3018001,
    3018002,
    3018003,
    3018004,
    3018005,
    3018006,
    3018007,
    3018008,
    3018009,
    3018010,
    3018011,
    3018012,
    3018013,
    3018014,
    3018015,
    3003001,
    3003002,
    3003003,
    3003004,
    3003005,
    3003006,
    3003007,
    3003008,
    3003009,
    3003010,
    3003011,
    3003012,
    3003013,
    3003014,
    3003015,
    3003016,
    3003017,
    3003018,
    3003019,
    3003020,
    3057001,
    3021001,
    3021002,
    3021003,
    3021004,
    3021005,
    3021006,
    3021007,
    3021008,
    3021009,
    3021010,
    3021011,
    3021012,
    3021013,
    3021014,
    3021015,
    3024001,
    3024002,
    3024003,
    3024004,
    3024005,
    3024006,
    3024007,
    3024008,
    3024009,
    3024010,
    3024011,
    3024012,
    3024013,
    3024014,
    3024015,
    3027001,
    3027002,
    3027003,
    3027004,
    3027005,
    3027006,
    3027007,
    3027008,
    3027009,
    3027010,
    3027011,
    3027012,
    3027013,
    3027014,
    3027015,
    3030001,
    3030002,
    3030003,
    3030004,
    3030005,
    3030006,
    3030007,
    3030008,
    3030009,
    3030010,
    3030011,
    3030012,
    3030013,
    3030014,
    3030015,
    3033001,
    3033002,
    3033003,
    3033004,
    3033005,
    3033006,
    3033007,
    3033008,
    3033009,
    3033010,
    3033011,
    3033012,
    3033013,
    3033014,
    3033015,
    3036001,
    3036002,
    3036003,
    3036004,
    3036005,
    3036006,
    3036007,
    3036008,
    3036009,
    3036010,
    3036011,
    3036012,
    3036013,
    3036014,
    3036015,
    3039001,
    3039002,
    3039003,
    3039004,
    3039005,
    3039006,
    3039007,
    3039008,
    3039009,
    3039010,
    3039011,
    3039012,
    3039013,
    3039014,
    3039015,
    3042001,
    3042002,
    3042003,
    3042004,
    3042005,
    3042006,
    3042007,
    3042008,
    3042009,
    3042010,
    3042011,
    3042012,
    3042013,
    3042014,
    3042015,
    3045001,
    3045002,
    3045003,
    3045004,
    3045005,
    3045006,
    3045007,
    3045008,
    3045009,
    3045010,
    3045011,
    3045012,
    3045013,
    3045014,
    3045015,
    3048001,
    3048002,
    3048003,
    3048004,
    3048005,
    3048006,
    3048007,
    3048008,
    3048009,
    3048010,
    3048011,
    3048012,
    3048013,
    3048014,
    3048015,
    3051001,
    3051002,
    3051003,
    3051004,
    3051005,
    3051006,
    3051007,
    3051008,
    3051009,
    3051010,
    3051011,
    3051012,
    3051013,
    3051014,
    3051015,
    3054001,
    3054002,
    3054003,
    3054004,
    3054005,
    3054006,
    3054007,
    3054008,
    3054009,
    3054010,
    3054011,
    3054012,
    3054013,
    3054014,
    3054015,
    3006001,
    3006002,
    3006003,
    3006004,
    3006005,
    3006006,
    3006007,
    3006008,
    3006009,
    3006010,
    3006011,
    3006012,
    3006013,
    3006014,
    3006015,
    3006016,
    3006017,
    3006018,
    3006019,
    3006020,
}



return mod

